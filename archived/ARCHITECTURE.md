# ğŸ—ï¸ ì‹¬ë¦¬ìƒë‹´ ì±—ë´‡ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

## ğŸ“Š ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ì‚¬ìš©ì (Browser)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP/WebSocket
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í”„ë¡ íŠ¸ì—”ë“œ (Next.js 15)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  App Router (RSC)                     Port: 3000             â”‚   â”‚
â”‚  â”‚  - í˜ì´ì§€: Home, Chat, Analytics                             â”‚   â”‚
â”‚  â”‚  - ì»´í¬ë„ŒíŠ¸: ChatInterface, EmotionDisplay, AvatarView      â”‚   â”‚
â”‚  â”‚  - ìƒíƒœê´€ë¦¬: Zustand / React Query                           â”‚   â”‚
â”‚  â”‚  - ìŠ¤íƒ€ì¼: Tailwind CSS + shadcn/ui                         â”‚   â”‚
â”‚  â”‚  - íƒ€ì…: TypeScript (strict mode)                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ REST API / WebSocket
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ë°±ì—”ë“œ API (NestJS + TypeScript)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API Gateway & Business Logic        Port: 3001             â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  ëª¨ë“ˆ êµ¬ì¡°:                                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ ChatModule         - ì±„íŒ… ì„¸ì…˜ ê´€ë¦¬                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ EmotionModule      - ê°ì • ë¶„ì„ ìš”ì²­ í”„ë¡ì‹œ               â”‚   â”‚
â”‚  â”‚  â”œâ”€ UserModule         - ì‚¬ìš©ì ê´€ë¦¬ (ì„ íƒ)                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ AnalyticsModule    - ëŒ€í™” ë¶„ì„ ë° í†µê³„                   â”‚   â”‚
â”‚  â”‚  â””â”€ WebSocketGateway   - ì‹¤ì‹œê°„ í†µì‹                          â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL (TypeORM)                           â”‚   â”‚
â”‚  â”‚  ìºì‹±: Redis (ì±„íŒ… íˆìŠ¤í† ë¦¬, ì„¸ì…˜)                            â”‚   â”‚
â”‚  â”‚  ì¸ì¦: JWT (ì„ íƒì )                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP (Internal)
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI ëª¨ë¸ ì„œë¹™ (FastAPI + Python)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ML Model Serving                     Port: 8000            â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  ì—”ë“œí¬ì¸íŠ¸:                                                   â”‚   â”‚
â”‚  â”‚  POST /api/v1/analyze        - ê°ì • ë¶„ì„                     â”‚   â”‚
â”‚  â”‚  POST /api/v1/generate-avatar - ì•„ë°”íƒ€ ìƒì„±                 â”‚   â”‚
â”‚  â”‚  POST /api/v1/assess-risk    - ìœ„í—˜ë„ í‰ê°€                  â”‚   â”‚
â”‚  â”‚  GET  /api/v1/health         - í—¬ìŠ¤ì²´í¬                     â”‚   â”‚
â”‚  â”‚  GET  /metrics               - Prometheus ë©”íŠ¸ë¦­            â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  ëª¨ë¸: KLUE-BERT (checkpoints_kfold/)                        â”‚   â”‚
â”‚  â”‚  ìºì‹±: ì¸ë©”ëª¨ë¦¬ LRU ìºì‹œ                                      â”‚   â”‚
â”‚  â”‚  ëª¨ë‹ˆí„°ë§: Prometheus + Grafana                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ê° ë ˆì´ì–´ ìƒì„¸ ì„¤ê³„

### 1ï¸âƒ£ **í”„ë¡ íŠ¸ì—”ë“œ (Next.js 15 + App Router)**

#### ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
frontend-next/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx                 # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”œâ”€â”€ page.tsx                   # í™ˆí˜ì´ì§€
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ page.tsx               # ì±„íŒ… í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ [sessionId]/
â”‚   â”‚       â””â”€â”€ page.tsx           # ì„¸ì…˜ë³„ ì±„íŒ…
â”‚   â”œâ”€â”€ analytics/
â”‚   â”‚   â””â”€â”€ page.tsx               # ê°ì • ë¶„ì„ í†µê³„
â”‚   â””â”€â”€ api/                       # Route Handlers
â”‚       â””â”€â”€ socket/
â”‚           â””â”€â”€ route.ts           # WebSocket í”„ë¡ì‹œ
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx      # ë©”ì¸ ì±„íŒ… UI
â”‚   â”‚   â”œâ”€â”€ MessageBubble.tsx      # ë©”ì‹œì§€ ë²„ë¸”
â”‚   â”‚   â”œâ”€â”€ InputBox.tsx           # ì…ë ¥ì°½
â”‚   â”‚   â””â”€â”€ TypingIndicator.tsx   # íƒ€ì´í•‘ í‘œì‹œ
â”‚   â”œâ”€â”€ emotion/
â”‚   â”‚   â”œâ”€â”€ EmotionBadge.tsx       # ê°ì • ë°°ì§€
â”‚   â”‚   â”œâ”€â”€ EmotionChart.tsx       # ê°ì • ì°¨íŠ¸
â”‚   â”‚   â””â”€â”€ RiskAlert.tsx          # ìœ„í—˜ë„ ê²½ê³ 
â”‚   â”œâ”€â”€ avatar/
â”‚   â”‚   â”œâ”€â”€ AvatarDisplay.tsx      # ì•„ë°”íƒ€ í‘œì‹œ
â”‚   â”‚   â””â”€â”€ AvatarAnimation.tsx    # ì•„ë°”íƒ€ ì• ë‹ˆë©”ì´ì…˜
â”‚   â””â”€â”€ ui/                        # shadcn/ui ì»´í¬ë„ŒíŠ¸
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ chat.ts                # ì±„íŒ… API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ emotion.ts             # ê°ì • API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â””â”€â”€ websocket.ts           # WebSocket í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useChat.ts             # ì±„íŒ… í›…
â”‚   â”‚   â”œâ”€â”€ useEmotion.ts          # ê°ì • ë¶„ì„ í›…
â”‚   â”‚   â””â”€â”€ useAvatar.ts           # ì•„ë°”íƒ€ í›…
â”‚   â””â”€â”€ store/
â”‚       â”œâ”€â”€ chatStore.ts           # ì±„íŒ… ìƒíƒœ (Zustand)
â”‚       â””â”€â”€ emotionStore.ts        # ê°ì • ìƒíƒœ
â”‚
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ chat.ts                    # ì±„íŒ… íƒ€ì…
â”‚   â”œâ”€â”€ emotion.ts                 # ê°ì • íƒ€ì…
â”‚   â””â”€â”€ api.ts                     # API ì‘ë‹µ íƒ€ì…
â”‚
â””â”€â”€ package.json
```

#### ğŸ”‘ í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ
- **Framework**: Next.js 15 (App Router, RSC)
- **Language**: TypeScript 5.3+
- **Styling**: Tailwind CSS 3.4 + shadcn/ui
- **State**: Zustand + React Query (TanStack Query)
- **Real-time**: Socket.io-client
- **Forms**: React Hook Form + Zod
- **Charts**: Recharts / Chart.js
- **Animation**: Framer Motion

---

### 2ï¸âƒ£ **ë°±ì—”ë“œ API (NestJS + TypeScript)**

#### ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
backend-nest/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                    # ì• í”Œë¦¬ì¼€ì´ì…˜ ì—”íŠ¸ë¦¬
â”‚   â”œâ”€â”€ app.module.ts              # ë£¨íŠ¸ ëª¨ë“ˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ chat.module.ts
â”‚   â”‚   â”œâ”€â”€ chat.controller.ts     # REST ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ chat.service.ts        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ chat.gateway.ts        # WebSocket ê²Œì´íŠ¸ì›¨ì´
â”‚   â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”‚   â”œâ”€â”€ chat-session.entity.ts
â”‚   â”‚   â”‚   â””â”€â”€ message.entity.ts
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚       â”œâ”€â”€ create-message.dto.ts
â”‚   â”‚       â””â”€â”€ session.dto.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ emotion/
â”‚   â”‚   â”œâ”€â”€ emotion.module.ts
â”‚   â”‚   â”œâ”€â”€ emotion.controller.ts  # í”„ë¡ì‹œ ì»¨íŠ¸ë¡¤ëŸ¬
â”‚   â”‚   â”œâ”€â”€ emotion.service.ts     # FastAPI í˜¸ì¶œ
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚       â”œâ”€â”€ analyze-emotion.dto.ts
â”‚   â”‚       â””â”€â”€ emotion-result.dto.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ analytics/
â”‚   â”‚   â”œâ”€â”€ analytics.module.ts
â”‚   â”‚   â”œâ”€â”€ analytics.controller.ts
â”‚   â”‚   â”œâ”€â”€ analytics.service.ts   # í†µê³„ ê³„ì‚°
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚       â””â”€â”€ emotion-stats.dto.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ user/ (ì„ íƒì )
â”‚   â”‚   â”œâ”€â”€ user.module.ts
â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ user.entity.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ filters/               # Exception filters
â”‚   â”‚   â”œâ”€â”€ guards/                # Auth guards
â”‚   â”‚   â”œâ”€â”€ interceptors/          # Response interceptors
â”‚   â”‚   â”œâ”€â”€ pipes/                 # Validation pipes
â”‚   â”‚   â””â”€â”€ decorators/            # Custom decorators
â”‚   â”‚
â”‚   â””â”€â”€ config/
â”‚       â”œâ”€â”€ database.config.ts     # DB ì„¤ì •
â”‚       â”œâ”€â”€ redis.config.ts        # Redis ì„¤ì •
â”‚       â””â”€â”€ app.config.ts          # ì•± ì„¤ì •
â”‚
â”œâ”€â”€ test/                          # E2E í…ŒìŠ¤íŠ¸
â”œâ”€â”€ prisma/ (ë˜ëŠ” TypeORM migrations)
â””â”€â”€ package.json
```

#### ğŸ”‘ í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ
- **Framework**: NestJS 10+
- **Language**: TypeScript 5.3+
- **ORM**: TypeORM / Prisma
- **Database**: PostgreSQL 15+
- **Cache**: Redis 7+
- **WebSocket**: @nestjs/websockets + socket.io
- **Validation**: class-validator + class-transformer
- **HTTP Client**: Axios
- **Testing**: Jest + Supertest
- **Documentation**: Swagger (@nestjs/swagger)

---

### 3ï¸âƒ£ **AI ëª¨ë¸ ì„œë¹™ (FastAPI + Python)**

#### ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
ml-serving/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                    # FastAPI ì•±
â”‚   â”œâ”€â”€ config.py                  # ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ router.py          # API ë¼ìš°í„°
â”‚   â”‚       â””â”€â”€ endpoints/
â”‚   â”‚           â”œâ”€â”€ emotion.py     # ê°ì • ë¶„ì„ ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚           â”œâ”€â”€ avatar.py      # ì•„ë°”íƒ€ ìƒì„±
â”‚   â”‚           â””â”€â”€ risk.py        # ìœ„í—˜ë„ í‰ê°€
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ emotion_classifier.py # ëª¨ë¸ ë˜í¼
â”‚   â”‚   â”œâ”€â”€ avatar_generator.py   # ì•„ë°”íƒ€ ìƒì„±ê¸°
â”‚   â”‚   â””â”€â”€ risk_assessor.py      # ìœ„í—˜ë„ í‰ê°€ê¸°
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ emotion.py             # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”œâ”€â”€ avatar.py
â”‚   â”‚   â””â”€â”€ common.py
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ inference.py           # ì¶”ë¡  ì„œë¹„ìŠ¤
â”‚   â”‚   â”œâ”€â”€ preprocessing.py      # ì „ì²˜ë¦¬
â”‚   â”‚   â””â”€â”€ cache.py              # ìºì‹± ì„œë¹„ìŠ¤
â”‚   â”‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ model_loader.py       # ëª¨ë¸ ë¡œë”
â”‚   â”‚   â”œâ”€â”€ metrics.py            # Prometheus ë©”íŠ¸ë¦­
â”‚   â”‚   â””â”€â”€ logging.py            # ë¡œê¹… ì„¤ì •
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ image.py              # ì´ë¯¸ì§€ ì²˜ë¦¬
â”‚       â””â”€â”€ text.py               # í…ìŠ¤íŠ¸ ì²˜ë¦¬
â”‚
â”œâ”€â”€ checkpoints/                   # í•™ìŠµëœ ëª¨ë¸ (ì‹¬ë³¼ë¦­ ë§í¬)
â”œâ”€â”€ tests/
â”œâ”€â”€ requirements.txt
â””â”€â”€ Dockerfile
```

#### ğŸ”‘ í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ
- **Framework**: FastAPI 0.115+
- **ML**: PyTorch 2.5+, Transformers 4.44+
- **Image**: Pillow 12+
- **Server**: Uvicorn (ASGI)
- **Validation**: Pydantic 2.12+
- **Monitoring**: prometheus-client
- **Caching**: functools.lru_cache / Redis
- **Testing**: pytest + httpx

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### ì±„íŒ… + ê°ì • ë¶„ì„ í”Œë¡œìš°
```
1. ì‚¬ìš©ì ë©”ì‹œì§€ ì…ë ¥ (Next.js)
   â†“
2. WebSocketìœ¼ë¡œ NestJS ì „ì†¡
   â†“
3. NestJS: ë©”ì‹œì§€ ì €ì¥ (PostgreSQL)
   â†“
4. NestJS â†’ FastAPI: ê°ì • ë¶„ì„ ìš”ì²­
   POST http://ml-serving:8000/api/v1/analyze
   {
     "text": "ì˜¤ëŠ˜ ë„ˆë¬´ ìš°ìš¸í•´ìš”",
     "session_id": "uuid"
   }
   â†“
5. FastAPI: 
   - KLUE-BERT ëª¨ë¸ ì¶”ë¡ 
   - ìœ„í—˜ë„ í‰ê°€
   - ì•„ë°”íƒ€ ì´ë¯¸ì§€ ìƒì„±
   â†“
6. FastAPI â†’ NestJS: ë¶„ì„ ê²°ê³¼ ë°˜í™˜
   {
     "emotion": "sad",
     "confidence": 0.87,
     "risk_level": "medium",
     "avatar_url": "data:image/png;base64,...",
     "probabilities": {...}
   }
   â†“
7. NestJS: ë¶„ì„ ê²°ê³¼ ì €ì¥ + Redis ìºì‹±
   â†“
8. NestJS â†’ Next.js: WebSocketìœ¼ë¡œ ì‹¤ì‹œê°„ ì „ì†¡
   â†“
9. Next.js: UI ì—…ë°ì´íŠ¸
   - ê°ì • ë°°ì§€ í‘œì‹œ
   - ì•„ë°”íƒ€ ì´ë¯¸ì§€ í‘œì‹œ
   - ìœ„í—˜ë„ ì•Œë¦¼ (í•„ìš”ì‹œ)
```

---

## ğŸ³ Docker Compose êµ¬ì„±

```yaml
version: '3.8'

services:
  # í”„ë¡ íŠ¸ì—”ë“œ
  frontend:
    build: ./frontend-next
    ports:
      - "3000:3000"
    environment:
      - NEXT_PUBLIC_API_URL=http://backend:3001
      - NEXT_PUBLIC_WS_URL=ws://backend:3001
    depends_on:
      - backend

  # ë°±ì—”ë“œ API
  backend:
    build: ./backend-nest
    ports:
      - "3001:3001"
    environment:
      - DATABASE_URL=postgresql://user:pass@postgres:5432/chatbot
      - REDIS_URL=redis://redis:6379
      - ML_SERVICE_URL=http://ml-serving:8000
    depends_on:
      - postgres
      - redis
      - ml-serving

  # ML ì„œë¹™
  ml-serving:
    build: ./ml-serving
    ports:
      - "8000:8000"
    volumes:
      - ./checkpoints_kfold:/app/checkpoints
    environment:
      - MODEL_PATH=/app/checkpoints/fold1_model_20251028_113127.pt
      - DEVICE=cuda  # ë˜ëŠ” cpu
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  # PostgreSQL
  postgres:
    image: postgres:15-alpine
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=chatbot_user
      - POSTGRES_PASSWORD=chatbot_pass
      - POSTGRES_DB=chatbot
    volumes:
      - postgres_data:/var/lib/postgresql/data

  # Redis
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  # Nginx (ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ)
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - frontend
      - backend

volumes:
  postgres_data:
  redis_data:
```

---

## ğŸ“¡ API ì„¤ê³„

### NestJS Backend API

#### Chat Endpoints
```typescript
// ì±„íŒ… ì„¸ì…˜ ìƒì„±
POST /api/chat/sessions
Response: { sessionId: string, createdAt: Date }

// ë©”ì‹œì§€ ì „ì†¡
POST /api/chat/sessions/:sessionId/messages
Body: { text: string, userId?: string }
Response: { messageId: string, emotion: EmotionResult }

// ì„¸ì…˜ ì¡°íšŒ
GET /api/chat/sessions/:sessionId
Response: { session: Session, messages: Message[] }

// WebSocket
WS /chat
Events: 
  - message (client â†’ server)
  - emotion-result (server â†’ client)
  - typing (bidirectional)
```

#### Emotion Endpoints (Proxy)
```typescript
// ê°ì • ë¶„ì„
POST /api/emotion/analyze
Body: { text: string }
Response: { emotion: string, confidence: number, ... }

// ì•„ë°”íƒ€ ìƒì„±
POST /api/emotion/generate-avatar
Body: { text: string, emotion?: string }
Response: { avatarUrl: string, emotion: string }
```

#### Analytics Endpoints
```typescript
// ì„¸ì…˜ í†µê³„
GET /api/analytics/sessions/:sessionId/stats
Response: { emotionDistribution: {...}, timeline: [...] }

// ì „ì²´ í†µê³„
GET /api/analytics/overview
Response: { totalSessions: number, emotionTrends: {...} }
```

### FastAPI ML Serving API

```python
# ê°ì • ë¶„ì„
POST /api/v1/analyze
{
  "text": "ì˜¤ëŠ˜ ë„ˆë¬´ í–‰ë³µí•´ìš”!",
  "session_id": "optional-uuid"
}
Response: {
  "emotion": "joy",
  "emotion_kr": "ê¸°ì¨",
  "confidence": 0.92,
  "probabilities": {...},
  "inference_time_ms": 45
}

# ì•„ë°”íƒ€ ìƒì„±
POST /api/v1/generate-avatar
{
  "emotion": "joy",
  "style": "gradient"  # optional
}
Response: {
  "avatar_url": "data:image/png;base64,...",
  "emotion": "joy",
  "generation_time_ms": 120
}

# ìœ„í—˜ë„ í‰ê°€
POST /api/v1/assess-risk
{
  "text": "...",
  "emotion": "sad"
}
Response: {
  "risk_level": "high",
  "risk_score": 0.78,
  "recommendations": [...]
}

# í—¬ìŠ¤ì²´í¬
GET /api/v1/health
Response: {
  "status": "healthy",
  "model_loaded": true,
  "gpu_available": true
}
```

---

## ğŸš€ ê°œë°œ ë¡œë“œë§µ

### Phase 1: ê¸°ë°˜ êµ¬ì¶• (1-2ì¼)
- [ ] í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±
- [ ] Docker Compose ì„¤ì •
- [ ] ê¸°ë³¸ í™˜ê²½ ì„¤ì • (ENV, Config)

### Phase 2: ML ì„œë¹™ (1ì¼)
- [ ] FastAPI ê¸°ë³¸ êµ¬ì¡°
- [ ] ê¸°ì¡´ ëª¨ë¸ í†µí•©
- [ ] ê°ì • ë¶„ì„ API êµ¬í˜„
- [ ] ì•„ë°”íƒ€ ìƒì„± API êµ¬í˜„

### Phase 3: ë°±ì—”ë“œ API (2ì¼)
- [ ] NestJS í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
- [ ] Database ìŠ¤í‚¤ë§ˆ ì„¤ê³„
- [ ] Chat ëª¨ë“ˆ êµ¬í˜„
- [ ] WebSocket ê²Œì´íŠ¸ì›¨ì´
- [ ] FastAPI ì—°ë™

### Phase 4: í”„ë¡ íŠ¸ì—”ë“œ (2-3ì¼)
- [ ] Next.js 15 í”„ë¡œì íŠ¸ ì„¤ì •
- [ ] UI ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ (shadcn/ui)
- [ ] ì±„íŒ… ì¸í„°í˜ì´ìŠ¤
- [ ] ê°ì • ì‹œê°í™”
- [ ] WebSocket ì—°ë™

### Phase 5: í†µí•© ë° í…ŒìŠ¤íŠ¸ (1-2ì¼)
- [ ] End-to-end í…ŒìŠ¤íŠ¸
- [ ] ì„±ëŠ¥ ìµœì í™”
- [ ] ì—ëŸ¬ í•¸ë“¤ë§
- [ ] ëª¨ë‹ˆí„°ë§ ì„¤ì •

---

## ğŸ’° ë¹„ìš© ë° ë¦¬ì†ŒìŠ¤

### ê°œë°œ í™˜ê²½
- **ë¡œì»¬**: Docker Desktop + WSL2
- **ë¹„ìš©**: ë¬´ë£Œ

### í”„ë¡œë•ì…˜ (ì˜ˆìƒ)
- **Frontend (Vercel)**: ë¬´ë£Œ ~ $20/ì›”
- **Backend (Railway/Render)**: $5-20/ì›”
- **Database (Supabase)**: ë¬´ë£Œ ~ $25/ì›”
- **ML Serving (RunPod/Modal)**: $0.15-0.5/hour (GPU)
- **ì´ ì˜ˆìƒ**: $20-100/ì›”

---

## ğŸ¯ ì¥ì 

1. **í™•ì¥ì„±**: ê° ì„œë¹„ìŠ¤ ë…ë¦½ì ìœ¼ë¡œ ìŠ¤ì¼€ì¼ë§
2. **ìœ ì§€ë³´ìˆ˜**: ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬
3. **ê°œë°œ ì†ë„**: TypeScriptë¡œ íƒ€ì… ì•ˆì •ì„±
4. **ì„±ëŠ¥**: Next.js RSC + Redis ìºì‹±
5. **ì „ë¬¸ì„±**: ì‚°ì—… í‘œì¤€ ê¸°ìˆ  ìŠ¤íƒ
6. **ë°°í¬**: Dockerë¡œ í™˜ê²½ ì¼ê´€ì„±
7. **ëª¨ë‹ˆí„°ë§**: Prometheus + Grafana í†µí•© ê°€ëŠ¥

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- **Next.js**: https://nextjs.org/docs
- **NestJS**: https://docs.nestjs.com
- **FastAPI**: https://fastapi.tiangolo.com
- **TypeORM**: https://typeorm.io
- **Prisma**: https://www.prisma.io/docs
- **shadcn/ui**: https://ui.shadcn.com

---

**ì‘ì„±ì¼**: 2025-10-28  
**ë²„ì „**: 1.0.0  
**ìƒíƒœ**: ì„¤ê³„ ì™„ë£Œ, êµ¬í˜„ ëŒ€ê¸°
